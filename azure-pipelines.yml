trigger:
- '*'

jobs:
- job: RunCurlCommand
  steps:
  - script: |
      curl -X 'POST' \
        -H 'accept: application/json' \
        -H 'Authorization: Api-Key h360roq.nexa.kzextcnz0hzny5c2m8okbf8mzl00ilej' \
        -H 'Content-Type: application/json' \
        -d '{
          "tests": [
            "csrf",
            "sqli"
          ],
          "discoveryTypes": [
            "crawler"
          ],
          "poolSize": 50,
          "crawlerUrls": [
            "https://brokencrystals.com"
          ],
          "smart": true,
          "optimizedCrawler": true,
          "maxInteractionsChainLength": 5,
          "skipStaticParams": true,
          "exclusions": {
            "requests": [
              {
                "patterns": [
                  "(?<excluded_file_ext>(\\/\\/[^?#]+\\.)((?<image>jpg|jpeg|png|gif|svg)|(?<font>ttf|otf|fnt|fon))(?:$|#|\\?))"
                ],
                "methods": [
                  "GET"
                ]
              }
            ],
            "params": [
              "^(?!.*login).*$"
            ],
            "htmlSelectors": [
              "/html/body/div[1]/table/tbody/tr/td[8]/a",
              ".mat-focus-indicator .mat-menu-item ng-tns-c46-3"
            ]
          },
          "module": "dast",
          "info": {
            "client": {
              "name": "bright-cli",
              "version": "10.0.0"
            },
          },
        }'
